@page "/Overview"
@using ArcheryTracker.Logic
@using ArcheryTracker.Logic.Models
@using ArcheryTracker.App.Util

@inject UserService UserService
@inject IdentityService IdentityService

@attribute [Authorize]

@if (_user == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <p>Total Shots: @_user.TotalShots</p>
    <p>Shots Per Session: @_user.ShotsPerSession</p>
    <p>Total Shots This Month: @_user.ShotsThisMonth</p>
    <p>Overall Accuracy: @_user.OverallAccuracy%</p>
    <p>Bullseye Percentage: @_user.OverallBullseyeAccuracy%</p>

    <a class="nav-link" href="/mysessions">See my sessions</a>
}

@code {
    private UserStats _user { get; set; }

    protected override async Task OnInitializedAsync()
    {
        var userId = await IdentityService.GetClaim("nameidentifier");
        _user = await UserService.GetUser(userId);
    }
}